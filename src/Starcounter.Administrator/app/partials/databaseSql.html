
<div ng-show="database" class="panel panel-default">

    <div class="panel-heading">
        <div class="btn-toolbar" role="toolbar">
            <div class="btn-group btn-group-sm">
                <!-- Query history -->
                <button style="min-width: 100px" type="submit" class="btn btn-default btn-success" ng-disabled="!canExecute()" ng-click="btnExecute(queryState.sqlQuery,database.ID)" title="Execute query (CTRL+Enter)">{{executeButtonTitle(isBusy)}}</button>

                <button class="btn btn-default btn-success dropdown-toggle" data-toggle="dropdown" title="Query history">
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li role="presentation" ng-repeat="item in queryHistory | orderBy:reverse track by $index" title="{{item.statement}}">
                        <a href="" role="menuitem" ng-click="btnSelectQuery(item)">{{$index+1}}. {{item.statement|truncate:80}}</a>
                    </li>
                </ul>
            </div>

            <div class="btn-group btn-group-sm">
                <div style="margin-top: 7px" ng-show="isBusy" title="{{executeButtonTitle(isBusy)}}" class="spinner tiny"></div>
            </div>

            <span ng-show="HasErrorMessage" class="btn-group btn-group-sm" style="vertical-align: middle; vertical-align: -webkit-baseline-middle; margin-left: 15px;margin-top:5px">
                <span style="vertical-align: middle; margin-top: -1px; font-size: 1.2em; color: #d9534f" class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" title="{{ErrorMessage.Message}}"></span>
                <span style="vertical-align: middle">{{ErrorMessage.Message}}</span>
                <a ng-show="ErrorMessage.HelpLink" href="{{ErrorMessage.HelpLink}}" target="_blank">What does it mean?</a>. View the <a href="#/server/log">log</a> for more details.
            </span>
        </div>
    </div>

    <div class="panel-body">
        <div style="margin-top: 15px; margin-bottom: 15px" title="SQL Query">
            <textarea id="sqlinput" ui-codemirror="{theme:'monokai'}" ng-model="queryState.sqlQuery"></textarea>
        </div>

        <div ng-hide='isBusy == true' style="margin-top: 15px; margin-bottom: -15px">

            <tabset>
                <tab heading="Result">
                  <div id="handsontableContainer" style="overflow-x: auto; overflow-y: visible">
                    <ui-handsontable
                        id="handsontable"
                        stretchh="'last'"
                        selectedindex="SelectedIndex"
                        outsideclickdeselects="false"
                        selectedindex="currentSelection"
                        columns="queryState.columns"
                        minsparerows="0"
                        startrows="0"
                        datarows="row in queryState.rows"
                        currentrowclassname="'currentRow'"
                        manualcolumnmove="false"
                        manualcolumnresize="false"
                        columnsorting="false"
                        nativescrollbars="true"
                        afterrender="afterRender"
                        fragmentselection="true">
                    </ui-handsontable>
                  </div>
                </tab>

                <tab heading="Queryplan">
                    <div style="margin-left: 15px; margin-right: 15px" ng-bind-html="queryState.queryPlan"></div>
               </tab>
            </tabset>
        </div>
    </div>
</div>

<div ng-hide="database" class="panel panel-default">
  <div class="panel-heading">
      Database not found. <a href="/#/databases">Continue.</a>
    </div>
</div>
