
<form class="form-inline">


    <!-- Query history -->
    <button ng-show="queryHistory.length==0" type="submit" class="btn btn-success input-medium" ng-disabled="!canExecute()" ng-click="btnExecute(queryState.sqlQuery,queryState.selectedDatabaseName)" title="Execute query (CTRL+Enter)">{{executeButtonTitle(isBusy)}}</button>
    <div class="btn-group" ng-hide="queryHistory.length==0">
        <button type="submit" class="btn btn-success input-medium" ng-disabled="!canExecute()" ng-click="btnExecute(queryState.sqlQuery,queryState.selectedDatabaseName)" title="Execute query (CTRL+Enter)">{{executeButtonTitle(isBusy)}}</button>

        <button class="btn btn-success dropdown-toggle" data-toggle="dropdown" title="Query history">
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">

            <li ng-repeat="item in queryHistory | orderBy:reverse track by $index" title="{{item.statement}}">
                <a ng-click="btnSelectQuery(item)">{{$index+1}}. {{item.statement|truncate:80}}</a>
            </li>

        </ul>

    </div>

    &nbsp;

    <select class="input-large" name="database" id="database" ui-select2 ng-model="queryState.selectedDatabaseName" ng-required="true" data-placeholder="Select a database">
        <option value=""></option>
        <option value="{{database.name}}" ng-repeat="database in databases | filter: {running:true} | orderBy: 'name'">{{database.name}}</option>
    </select>

</form>

<textarea id="sqlinput" ui-codemirror="{theme:'monokai'}" ng-model="queryState.sqlQuery"></textarea>

<br />

<div ng-show='isBusy == true' class="progress progress-striped active">
    <div class="bar" style="width: 100%;">Executing sql query</div>
</div>

<div ng-hide='isBusy == true'>

    <tabset>
        <tab heading="Result">
          <div id="handsontableContainer" style="overflow-x: auto; overflow-y: visible">
            <ui-handsontable
                id="handsontable"
                stretchh="'last'"
                selectedindex="SelectedIndex"
                outsideclickdeselects="false"
                selectedindex="currentSelection"
                columns="queryState.columns"
                minsparerows="0"
                startrows="0"
                datarows="row in queryState.rows"
                currentrowclassname="'currentRow'"
                manualcolumnmove="false"
                manualcolumnresize="false"
                columnsorting="false"
                nativescrollbars="true"
                afterrender="afterRender"
                fragmentselection="true">
            </ui-handsontable>
          </div>
        </tab>

        <tab heading="Queryplan">
            <div ng-bind-html="queryState.queryPlan"></div>
       </tab>
    </tabset>

</div>
